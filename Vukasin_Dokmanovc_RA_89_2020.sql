-- INSERTS INTO TIM
INSERT INTO TIM (IDTIM, NAZTIM, GODOSNTIM, LOKTIM)
    VALUES (0, 'Boston Celtics', '1946', 'Boston, Massachusetts');

INSERT INTO TIM (IDTIM, NAZTIM, GODOSNTIM, LOKTIM)
    VALUES (1, 'Los Angeles Lakers', '1947', 'Los Angeles, California');

INSERT INTO TIM (IDTIM, NAZTIM, GODOSNTIM, LOKTIM)
    VALUES (2, 'New York Knicks', '1946', 'New York, New York');

INSERT INTO TIM (IDTIM, NAZTIM, GODOSNTIM, LOKTIM)
    VALUES (3, 'Denver Nuggets', '1967', 'Denver, Colorado');

INSERT INTO TIM (IDTIM, NAZTIM, GODOSNTIM, LOKTIM)
    VALUES (4, 'San Antonio Spurs', '1967', 'San Antonio, Texas');



-- INSERTS INTO DRAFT:
INSERT INTO DRAFT(IDDRAFT, GODODRDRAFT, LOKODRDRAFT)
    VALUES (0, '2024', 'Philadelphia, Pennsylvania');

INSERT INTO DRAFT(IDDRAFT, GODODRDRAFT, LOKODRDRAFT)
    VALUES (1, '2025', 'New Orleans, Louisiana');

INSERT INTO DRAFT(IDDRAFT, GODODRDRAFT, LOKODRDRAFT)
    VALUES (2, '2026', 'Cleveland, Ohio');

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (0, 'Nikola', 'TopiÄ‡', TO_DATE('2005-08-10', 'YYYY-MM-DD'), '195', '92', 'Plejmejker (PG)', 9, 'Beograd, Serbia', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (1, 'Isaiah', 'Collier', TO_DATE('2005-07-16', 'YYYY-MM-DD'), '192', '95', 'Plejmejker (PG)', 10, 'Marietta, Georgia', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (2, 'Alex', 'Sarr', TO_DATE('2005-11-20', 'YYYY-MM-DD'), '213', '107', 'Centar (C)', 9, 'Paris, France', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (3, 'Ron', 'Holland', TO_DATE('2005-04-07', 'YYYY-MM-DD'), '203', '94', 'Krilni centar (PF)', 8, 'Duncanville, Texas', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (4, 'Donovan', 'Clingan', TO_DATE('2005-02-19', 'YYYY-MM-DD'), '215', '115', 'Centar (C)', 8, 'Bristol, Connecticut', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (5, 'Zacharie', 'Risacher', TO_DATE('2005-03-29', 'YYYY-MM-DD'), '203', '95', 'Krilo (SF)', 9, 'France', 0);


-- INSERTS INTO NOVAJLIJA:
INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (6, 'Stephon', 'Castle', TO_DATE('2005-07-10', 'YYYY-MM-DD'), '200', '93', 'Bek suter (SG)', 8, 'Denver, Colorado', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (7, 'Robert', 'Dillingham', TO_DATE('2005-04-14', 'YYYY-MM-DD'), '185', '80', 'Plejmejker (PG)', 7, 'Portland, Oregon', 0);

INSERT INTO NOVAJLIJA(IDNOV, IMENOV, PRZNOV, DATRODJNOV, VISNOV, TEZNOV, POZNOV, OCNOV, MESRODJNOV, IDDRAFT)
    VALUES (8, 'Kyle', 'Filipowski', TO_DATE('2005-11-04', 'YYYY-MM-DD'), '213', '100', 'Krilni centar (PF)', 8, 'Phoenix, Arizona', 0);


-- INSERTS INTO ZAPOSLENI:
INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (0, 'Brad', 'Stevens', TO_DATE('1976-10-22', 'YYYY-MM-DD'), 'Menadzer', 0);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (1, 'Rob', 'Pelinka', TO_DATE('1969-12-23', 'YYYY-MM-DD'), 'Menadzer', 1);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (2, 'Scott', 'Perry', TO_DATE('1963-06-10', 'YYYY-MM-DD'), 'Menadzer', 2);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (3, 'Calvin', 'Booth', TO_DATE('1976-05-07', 'YYYY-MM-DD'), 'Menadzer', 3);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (4, 'Brian', 'Wright', TO_DATE('1972-11-12', 'YYYY-MM-DD'), 'Menadzer', 4);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (5, 'Jayson', 'Tatum', TO_DATE('1998-10-10', 'YYYY-MM-DD'), 'Igrac', 0);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (6, 'Victor', 'Wembanyama', TO_DATE('2004-01-04', 'YYYY-MM-DD'), 'Igrac', 4);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (7, 'Nikola', 'Jokic', TO_DATE('1995-06-07', 'YYYY-MM-DD'), 'Igrac', 3);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (8, 'Joe', 'Mazzula', TO_DATE('1988-06-30', 'YYYY-MM-DD'), 'Trener', 0);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (9, 'Darvin', 'Ham', TO_DATE('1973-07-22', 'YYYY-MM-DD'), 'Trener', 1);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (10, 'Tom', 'Thibodeau', TO_DATE('1958-01-17', 'YYYY-MM-DD'), 'Trener', 2);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (11, 'Michael', 'Malone', TO_DATE('1971-09-15', 'YYYY-MM-DD'), 'Trener', 3);

INSERT INTO ZAPOSLENI(MATBRZAP, IMEZAP, PRZZAP, DATRODJZAP, ULOZAP, IDTIM)
    VALUES (12, 'Gregg', 'Popovich', TO_DATE('1949-01-28', 'YYYY-MM-DD'), 'Trener', 4);



-- INSERTS INTO MENADZER
INSERT INTO MENADZER(MATBRZAP)
    VALUES(0);
    
INSERT INTO MENADZER(MATBRZAP)
    VALUES(1);
    
INSERT INTO MENADZER(MATBRZAP)
    VALUES(2);
    
INSERT INTO MENADZER(MATBRZAP)
    VALUES(3);
    
INSERT INTO MENADZER(MATBRZAP)
    VALUES(4);



-- INSERTS INTO IGRAC
INSERT INTO IGRAC(MATBRZAP, IMEIGR, PRZIGR, DATRODJIGR, VISIGR, TEZIGR, POZIGR)
    VALUES (5, 'Jayson', 'Tatum', TO_DATE('1998-10-10', 'YYYY-MM-DD'), '203', '100', 'Krilo (SF)');
    
INSERT INTO IGRAC(MATBRZAP, IMEIGR, PRZIGR, DATRODJIGR, VISIGR, TEZIGR, POZIGR)
    VALUES (6, 'Victor', 'Wembanyama', TO_DATE('2004-01-04', 'YYYY-MM-DD'), '223', '105', 'Centar (C)');
    
INSERT INTO IGRAC(MATBRZAP, IMEIGR, PRZIGR, DATRODJIGR, VISIGR, TEZIGR, POZIGR)
    VALUES (7, 'Nikola', 'Jokic', TO_DATE('1995-06-07', 'YYYY-MM-DD'), '211', '110', 'Centar (C)');



--INSERTS INTO TRENER
INSERT INTO TRENER(MATBRZAP, GODISKTRENER, SPECTRENER, MATBRNADZAP)
    VALUES(8, 1, 'Napad', 8);
    
INSERT INTO TRENER(MATBRZAP, GODISKTRENER, SPECTRENER, MATBRNADZAP)
    VALUES(9, 1, 'Odnos sa igracima', 9);
    
INSERT INTO TRENER(MATBRZAP, GODISKTRENER, SPECTRENER, MATBRNADZAP)
    VALUES(10, 15, 'Odbrana', 10);
    
INSERT INTO TRENER(MATBRZAP, GODISKTRENER, SPECTRENER, MATBRNADZAP)
    VALUES(11, 10, 'Kretnja lopte, napad', 11);
    
INSERT INTO TRENER(MATBRZAP, GODISKTRENER, SPECTRENER, MATBRNADZAP)
    VALUES(12, 27, 'Napad i odbrana', 12);



-- INSERTS FOR PIK:
INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (0, '30', '1', '2024', 0, 0, 0, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (1, '24', '1', '2024', 1, 1, 1, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (2, '14', '1', '2024', 2, 2, 2, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (3, '11', '2', '2024', 3, 3, 3, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (4, '2', '1', '2024', 4, 4, 4, 0);
    
INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (5, '5', '2', '2024', 0, 0, 5, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (6, '15', '1', '2024', 0, 0, 6, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (7, '3', '1', '2024', 1, 1, 7, 0);

INSERT INTO PIK(IDPIK, REDBRPIK, BRRUNPIK, GODPIK, IDTIM, MATBRZAP, IDNOV, IDDRAFT)
    VALUES (8, '9', '1', '2024', 1, 1, 8, 0);



CREATE OR REPLACE VIEW TEAM_PICKS_VIEW AS
SELECT
    T.NAZTIM AS TEAM_NAME,
    COUNT(N.IMENOV) AS NUMBER_OF_PLAYERS,
    MIN(P.REDBRPIK) AS MIN_PICK_NUMBER,
    MAX(P.REDBRPIK) AS MAX_PICK_NUMBER,
    MIN(N.IMENOV || ' ' || N.PRZNOV) AS FIRST_PLAYER_NAME,
    MAX(N.IMENOV || ' ' || N.PRZNOV) AS LAST_PLAYER_NAME,
    D.GODODRDRAFT AS DRAFT_YEAR
FROM TIM T
LEFT JOIN PIK P ON T.IDTIM = P.IDTIM
LEFT JOIN NOVAJLIJA N ON P.IDNOV = N.IDNOV
LEFT JOIN DRAFT D ON P.IDDRAFT = D.IDDRAFT
WHERE D.GODODRDRAFT = '2024'
GROUP BY T.NAZTIM, D.GODODRDRAFT
HAVING COUNT(N.IMENOV) > 2
ORDER BY MIN(P.REDBRPIK) ASC;


CREATE OR REPLACE VIEW TEAM_MANAGER_PICKS_VIEW AS
SELECT
    T.NAZTIM AS TEAM_NAME,
    Z.IMEZAP || ' ' || Z.PRZZAP AS MANAGER_NAME,
    D.GODODRDRAFT AS DRAFT_YEAR,
    COUNT(P.IDPIK) AS NUMBER_OF_PICKS
FROM TIM T
LEFT JOIN ZAPOSLENI Z ON T.IDTIM = Z.IDTIM
LEFT JOIN PIK P ON T.IDTIM = P.IDTIM
LEFT JOIN DRAFT D ON P.IDDRAFT = D.IDDRAFT
GROUP BY T.NAZTIM, Z.IMEZAP, Z.PRZZAP, Z.ULOZAP, D.GODODRDRAFT
HAVING Z.ULOZAP = 'Menadzer'
ORDER BY T.NAZTIM, D.GODODRDRAFT;


CREATE OR REPLACE VIEW MOST_PICKED_POSITION_VIEW AS
SELECT
    D.GODODRDRAFT AS DRAFT_YEAR,
    N.POZNOV AS MOST_PICKED_POSITION,
    COUNT(N.POZNOV) AS PICK_COUNT
FROM NOVAJLIJA N
JOIN PIK P ON N.IDNOV = P.IDNOV
JOIN DRAFT D ON P.IDDRAFT = D.IDDRAFT
WHERE D.GODODRDRAFT = '2024'
GROUP BY D.GODODRDRAFT, N.POZNOV
HAVING COUNT(POZNOV) > 1
ORDER BY D.GODODRDRAFT, PICK_COUNT DESC;

